package com.a51tgt.fyj.ui.view;

import android.media.Image;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.text.TextUtils;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageView;
import android.widget.Switch;
import android.widget.TextView;
import android.widget.Toast;

import com.a51tgt.fyj.R;
import com.a51tgt.fyj.bluetooth.BluetoothUtil;
import com.a51tgt.fyj.comm.TcpConfig;

import org.json.JSONException;
import org.json.JSONObject;

public class OtherWiFiActivity extends AppCompatActivity implements View.OnClickListener{

    private ImageView iv_back;
    private EditText tv_name,tv_password;
    private Button btn_join;


    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_other_wi_fi);
        iv_back = (ImageView) findViewById(R.id.iv_back);
        tv_name = (EditText) findViewById(R.id.tv_name);
        tv_password = (EditText) findViewById(R.id.tv_password);
        iv_back.setOnClickListener(this);
        btn_join = (Button)findViewById(R.id.btn_joinWifi);
        btn_join.setOnClickListener(this);



    }

    @Override
    public void onClick(View v) {
        switch(v.getId()){
            case R.id.iv_back:
                finish();

                break;
            case  R.id.btn_joinWifi:

                if (TextUtils.isEmpty(tv_name.getText().toString())){
                    Toast.makeText(this,R.string.title_tip_nameempty,Toast.LENGTH_SHORT).show();

                   return;
            }

               else  if (TextUtils.isEmpty(tv_password.getText().toString())||tv_password.getText().toString().length()<8){
                    Toast.makeText(this, R.string.tip_password_at_least_8, Toast.LENGTH_LONG).show();

                    return;
                }
                BluetoothUtil.getInstance().sendMessage(buildCmdContent(tv_name.getText().toString(),tv_password.getText().toString(),TcpConfig.BT_CONNECT_TO_AP));
                finish();



                break;


        }

    }


    private String buildCmdContent(String ssid, String pwd, String cmd){
        JSONObject temp = new JSONObject();
        JSONObject res = new JSONObject();
        try {
            temp.put("ssid",ssid);
            temp.put("pwd",pwd);
            res.put(TcpConfig.KEY, cmd);
            res.put(TcpConfig.VALUE, temp.toString());
        }catch (JSONException e){
            e.printStackTrace();
        }
        return res.toString();
    }

}
